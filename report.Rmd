---
title: "VECM approach to interest rates"
subtitle: "Do short term rates lead long term rates?"
author: "Sean Cannon"
date: "`r format(Sys.Date(),'%B %d, %Y')`"
output:
  html_document:
    df_print: paged
    code_folding: hide
    toc: no
    fig_caption: yes
    theme: sandstone
    toc_float: no
  pdf_document:
    toc: no
---

---

```{r setup, include=FALSE}
rm(list=ls())
graphics.off()
# ECHO, MESSAGE, AND WARNING = FALSE for final knit
knitr::opts_chunk$set(echo = TRUE,
                      message = TRUE,
                      warning = TRUE)
```

```{r packages, message=FALSE, warning=FALSE}
require(fpp3)
require(tsibble)
require(tidyverse)
require(tidyquant)
require(kableExtra)
require(timetk)
require(vars)
require(lmtest)
require(reshape2)
require(urca)
require(stargazer)
require(tsDyn)
```

<br>
<h3>Abstract</h3>
<br>

Write the abstract here. Include at the end: The report is also posted online [here](https://scannon2k.github.io/projects.html).


---


<br>
<h3>Introduction</h3>
<br>

Write the introduction here.
<center>
```{r data}
# Vector of variables to be gathered:
vars <- c("GS2","GS10")

# Use tidyquant function tq_get to gather economic data from FRED and format as a tsibble
fred_data <- tq_get(vars,
                    get = "economic.data",
                    from = "1977-01-01")

# Pivot the data to be in a more conventional wide format
fred_dataw <- fred_data %>%
  pivot_wider(names_from = symbol, values_from = price) %>%
  tidyr::drop_na() %>%
  as_tsibble(index = date) %>%
  mutate(gs2 = `GS2`, gs10 = `GS10`) %>%
  dplyr::select(-c(`GS2`, `GS10`))

# plot
spread <- xts::xts(fred_dataw[,-1], order.by = fred_dataw$date)
plot(spread, main = "2 year treasury yields  (black) \n10 year treasury yields  (red)", ylab = "Percent", xlab="Month")
```
</center><br>

---


```{r roots}
# Check for unit roots: both variables I(1)
# fred_data %>% 
#   features(value, unitroot_ndiffs) %>% 
#   kable(format = "html", table.attr = "style='width:30%;' ") %>% 
#   kableExtra::kable_styling()
```

<br>
<h3>Data and Variables</h3>
<br>

The data used in this analysis was gathered from the Federal Reserve’s online database (FRED), and the time series spans from January 1977 to March 2022. The table below shows a list of the variables used and their attributes.


```{r data_table}
# Define description and units vectors for the table
desc <- c("Market Yield on U.S. Treasury Securities at 2-Year Constant Maturity","Market Yield on U.S. Treasury Securities at 10-Year Constant Maturity")
units <- c("Percent, Not Seasonally Adjusted","Percent, Not Seasonally Adjusted")

# Create dataframe for kable function
table_data <- data.frame(vars, desc, units)

# Table displaying variables, description, and units
kbl(table_data, col.names = c("Variables", "Description", "Units"), align = "lll") %>%
  kable_styling(bootstrap_options = c("bordered", "hover"))
```
<br>

Write about the data and variables here.

---


```{r selection}
# test for unit roots
summary(ur.df(spread$gs2, type = "none", selectlags = "BIC"))
summary(ur.df(spread$gs10, type = "none", selectlags = "BIC"))

# test for cointegration
coint.tr <- lm(spread$gs2 ~ spread$gs10)
summary(coint.tr)

# examine residuals for cointegration: residuals I(0)
coint.tr.resids <- coint.tr$residuals
summary(ur.df(coint.tr.resids, type = "drift", selectlags = "BIC"))
```


<br>
<h3>Model Selection</h3>
<br>


2 ADF tests on variables: accept the null that both have unit roots and are I(1) time series

Cointegration test: reject the null that there is a unit root in the residuals, residuals I(0), the two rates are cointegrated

gs10 is about 1.12% higher than gs2, on average


<br>
<center>$\pi^{12}_{t}−\pi_{t−12}=\phi+\beta(B)\Delta\pi_{t−12}+\gamma(B)u_{t−12}+\varepsilon_t$</center>
<br>

Keep talking about the models here ($\bar{\pi}$).

<br>
<center>$me=(m1+m2+m3+m4)/4$</center>
<br>

---


```{r vecm}
# estimate a VECM model with p-1 lags
p.tr <- VARselect(spread[,c(2,1)],lag.max=20,type="const")$selection[2] - 1
spread.vecm <- VECM(spread[,c(2,1)],lag=p.tr,r=1,include="const",estim="ML",LRinclude="none")
summary(spread.vecm)
```


<br>
<h3>Findings</h3>
<br>

Write about the results here.


```{r irf}
plot(irf(spread.vecm, n.ahead = 12))
```
<br>

Keep writing about the results with latek maybe.

<br>
<center>$MAPE = mean(\left| p_t \right|)$</center>
<br>
<center>where, $p_t=100e_t/y_t$</center>


```{r fevd}
plot(fevd(spread.vecm, n.ahead = 12))
```
<br>

Results and tables etc.


Closing findings.


---


<br>
<h3>Conclusion</h3>
<br>

Write about the conclusion here.


---


<br>
<h3>References</h3>
<br>
Hyndman, Rob J. “Forecasting: Principles&nbsp;and&nbsp;Practice (3rd Ed).” OTexts. Accessed April 10, 2022. https://otexts.com/fpp3/.
<br><br>
